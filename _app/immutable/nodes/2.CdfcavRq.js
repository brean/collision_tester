var F=Object.defineProperty;var T=e=>{throw TypeError(e)};var Q=(e,t,s)=>t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var f=(e,t,s)=>Q(e,typeof t!="symbol"?t+"":t,s),R=(e,t,s)=>t.has(e)||T("Cannot "+s);var w=(e,t,s)=>(R(e,t,"read from private field"),s?s.call(e):t.get(e)),N=(e,t,s)=>t.has(e)?T("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),O=(e,t,s,r)=>(R(e,t,"write to private field"),r?r.call(e,s):t.set(e,s),s);import{t as ee,a as te}from"../chunks/BH3Qotk0.js";import{s as j,k as J,o as ie,p as se,h as k,$ as ae,a0 as re,a1 as ne,a2 as le,u as oe,r as ce,K as he,g as ve,f as de,L as fe,R as ue,a3 as _e,a4 as ge,a5 as ye,_ as y,Y,Z as B,a6 as xe}from"../chunks/xY76uWF4.js";import{b as H}from"../chunks/fLQdN3j0.js";let K=!1;function D(){K||(K=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const s of e.target.elements)(t=s.__on_r)==null||t.call(s)})},{capture:!0}))}function be(e){var t=ie,s=se;j(null),J(null);try{return e()}finally{j(t),J(s)}}function me(e,t,s,r=s){e.addEventListener(t,()=>be(s));const i=e.__on_r;i?e.__on_r=()=>{i(),r(!0)}:e.__on_r=()=>r(!0),D()}const Pe=Symbol("is custom element"),we=Symbol("is html");function U(e){if(k){var t=!1,s=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var r=e.value;V(e,"value",null),e.value=r}if(e.hasAttribute("checked")){var i=e.checked;V(e,"checked",null),e.checked=i}}};e.__on_r=s,ae(s),D()}}function V(e,t,s,r){var i=Me(e);k&&(i[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||i[t]!==(i[t]=s)&&(t==="loading"&&(e[re]=s),e.removeAttribute(t))}function Me(e){return e.__attributes??(e.__attributes={[Pe]:e.nodeName.includes("-"),[we]:e.namespaceURI===ne})}function q(e,t,s=t){var r=le();me(e,"input",i=>{var o=i?e.defaultValue:e.value;if(o=M(e)?p(o):o,s(o),r&&o!==(o=t())){var h=e.selectionStart,v=e.selectionEnd;e.value=o??"",v!==null&&(e.selectionStart=h,e.selectionEnd=Math.min(v,e.value.length))}}),(k&&e.defaultValue!==e.value||oe(t)==null&&e.value)&&s(M(e)?p(e.value):e.value),ce(()=>{var i=t();M(e)&&i===p(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function M(e){var t=e.type;return t==="number"||t==="range"}function p(e){return e===""?null:+e}var pe=ee('<div style="display: inline-block; vertical-align: top; margin-right: 20px;">Robot space<br> <canvas width="500" height="500" class="svelte-6m66rb"></canvas></div> <div style="display: inline-block; vertical-align: top;">configuration space<br> <canvas width="500" height="500" class="svelte-6m66rb"></canvas></div> <br> upper arm angle: <input type="text"><br> forearm angle: <input type="text"><br>',1);function Ae(e,t){var g;he(t,!0);const s=100;let r,i,o,h,v;class E{constructor(a){N(this,g);f(this,"color");f(this,"x");f(this,"y");f(this,"length");f(this,"child");this.color=a.color||"red",this.x=a.x||0,this.y=a.y||0,this.child=a.child,this.length=a.length||s,O(this,g,ge(ye(a.angle||Math.PI/4)))}get angle(){return ue(w(this,g))}set angle(a){_e(w(this,g),a,!0)}getEndPosition(){const a=this.x+this.length*Math.cos(this.angle),l=this.y-this.length*Math.sin(this.angle);return{x:a,y:l}}draw(a,l){this.x=a,this.y=l;const n=this.getEndPosition();i.lineWidth=3,i.beginPath(),i.moveTo(this.x,this.y),i.lineTo(n.x,n.y),i.stroke(),i.beginPath(),i.arc((this.x+n.x)/2,(this.y+n.y)/2,10,0,Math.PI*2),i.fillStyle=this.color,i.fill(),i.beginPath(),i.arc(n.x,n.y,5,0,Math.PI*2),i.fillStyle="black",i.strokStyle="black",i.fill(),this.child&&this.child.draw(n.x,n.y)}arcPos(){const a=this.getEndPosition();return{x:(this.x+a.x)/2,y:(this.y+a.y)/2}}isInsideJoint(a){const l=this.arcPos(),n=a.x-l.x,d=a.y-l.y;return n*n+d*d<=10*10}}g=new WeakMap;class G{constructor(a){f(this,"vertices");this.vertices=a}draw(a,l){i.fillStyle="gray",i.beginPath(),i.moveTo(this.vertices[0].x+a,this.vertices[0].y+l);for(let n=1;n<this.vertices.length;n++)i.lineTo(this.vertices[n].x+a,this.vertices[n].y+l);i.closePath(),i.fill()}isColliding(a){let l=!1;for(let n=0,d=this.vertices.length-1;n<this.vertices.length;d=n++){const A=this.vertices[n].x,P=this.vertices[n].y,z=this.vertices[d].x,C=this.vertices[d].y;P>a.y!=C>a.y&&a.x<(z-A)*(a.y-P)/(C-P)+A&&(l=!l)}return l}}let u=new E({length:s*.8}),_=new E({child:u,color:"blue"}),W=[new G([{x:20,y:20},{x:80,y:50},{x:50,y:80}])];function I(){i.clearRect(0,0,r.width,r.height),_.draw(r.width/2,r.height/2),h.clearRect(0,0,o.width,o.height),h.beginPath(),h.arc((_.angle+Math.PI)*o.width/(Math.PI*2),(u.angle+Math.PI)*o.height/(Math.PI*2),10,0,Math.PI*2),h.fillStyle="black",h.fill(),W.forEach(c=>{c.draw(r.width/2,r.height/2)})}function X(){if(!o||!r||!h&&(h=o.getContext("2d"),!h)||!i&&(i=r.getContext("2d"),!i))return;r.addEventListener("pointerdown",a=>{const l=c(r,a);u.isInsideJoint(l)?v=u:_.isInsideJoint(l)&&(v=_)}),r.addEventListener("pointerup",()=>{v=void 0}),r.addEventListener("pointermove",a=>{if(v){const l=c(r,a),n=l.x-v.x,d=l.y-v.y;v.angle=Math.atan2(-d,n),I()}});function c(a,l){const n=a.getBoundingClientRect();return{x:l.clientX-n.left,y:l.clientY-n.top}}I()}ve(X);var S=pe(),x=de(S),Z=y(Y(x),3);H(Z,c=>r=c,()=>r),B(x);var b=y(x,2),$=y(Y(b),3);H($,c=>o=c,()=>o),B(b);var m=y(b,4);U(m);var L=y(m,3);U(L),xe(),q(m,()=>u.angle,c=>u.angle=c),q(L,()=>_.angle,c=>_.angle=c),te(e,S),fe()}export{Ae as component};
